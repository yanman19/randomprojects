<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lifetime Spending Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: #0d1117;
            color: #e6edf3;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(22, 27, 34, 0.8);
            border: 1px solid #30363d;
            border-radius: 16px;
            box-shadow: 0 16px 32px rgba(1, 4, 9, 0.85);
            overflow: hidden;
            backdrop-filter: blur(16px);
        }

        .header {
            background: linear-gradient(135deg, #1f6feb 0%, #388bfd 100%);
            color: white;
            padding: 32px;
            text-align: center;
            border-bottom: 1px solid #30363d;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 8px;
            font-weight: 600;
            letter-spacing: -0.025em;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .main-content {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 0;
            min-height: 600px;
        }

        .sidebar {
            background: rgba(13, 17, 23, 0.6);
            border-right: 1px solid #30363d;
            padding: 20px;
        }

        .content-area {
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .input-section {
            background: rgba(22, 27, 34, 0.8);
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #e6edf3;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid #30363d;
        }

        .input-group {
            margin-bottom: 14px;
        }

        .input-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #e6edf3;
            font-size: 0.9rem;
        }

        .input-group input {
            width: 100%;
            padding: 10px 12px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            color: #e6edf3;
            font-size: 0.95rem;
            transition: all 0.2s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: #1f6feb;
            box-shadow: 0 0 0 3px rgba(31, 111, 235, 0.15);
        }

        .input-group input::placeholder {
            color: #7d8590;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 24px;
        }

        .funding-status {
            background: rgba(22, 27, 34, 0.8);
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 24px;
            order: -1;
        }

        .savings-progress {
            margin-bottom: 20px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #e6edf3;
        }

        .progress-percentage {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f6feb;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #21262d;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #1f6feb 0%, #388bfd 100%);
            border-radius: 6px;
            transition: width 0.8s ease;
            position: relative;
        }

        .progress-fill.over-funded {
            background: linear-gradient(90deg, #238636 0%, #2ea043 100%);
        }

        .progress-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-top: 16px;
        }

        .detail-card {
            background: rgba(13, 17, 23, 0.6);
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .detail-label {
            font-size: 0.8rem;
            color: #7d8590;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #e6edf3;
        }

        .detail-value.positive {
            color: #2ea043;
        }

        .detail-value.negative {
            color: #f85149;
        }

        .result-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }

        .result-card {
            background: rgba(22, 27, 34, 0.8);
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .result-card h3 {
            color: #7d8590;
            font-size: 0.85rem;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }

        .result-card .value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #e6edf3;
            margin-bottom: 4px;
        }

        .result-card .currency {
            color: #1f6feb;
        }

        .chart-container {
            background: rgba(22, 27, 34, 0.8);
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 24px;
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #e6edf3;
            margin-bottom: 20px;
            text-align: center;
        }

        #spendingChart {
            max-height: 400px;
        }

        .formula-info {
            background: rgba(56, 139, 253, 0.1);
            border: 1px solid rgba(56, 139, 253, 0.2);
            border-radius: 8px;
            padding: 12px;
            margin-top: 16px;
            font-size: 0.85rem;
            color: #e6edf3;
        }

        .formula-info strong {
            display: block;
            margin-bottom: 6px;
            color: #58a6ff;
        }

        .life-events-section {
            background: rgba(22, 27, 34, 0.8);
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 16px;
        }

        .add-event-form {
            margin-bottom: 16px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 80px 1fr;
            gap: 8px;
            margin-bottom: 12px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .add-event-form input {
            padding: 10px 12px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            color: #e6edf3;
            font-size: 0.9rem;
            transition: border-color 0.2s ease;
        }

        .add-event-form input:focus {
            border-color: #1f6feb;
            outline: none;
        }

        .add-event-form label {
            display: block;
            margin-bottom: 6px;
            font-size: 0.8rem;
            color: #7d8590;
            font-weight: 500;
        }

        .btn-add {
            width: 100%;
            margin-top: 8px;
        }

        .btn-primary {
            padding: 8px 16px;
            background: #238636;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background 0.2s ease;
        }

        .btn-primary:hover {
            background: #2ea043;
        }

        .btn-danger {
            background: #da3633;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background 0.2s ease;
        }

        .btn-danger:hover {
            background: #f85149;
        }

        .event-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
            border: 1px solid #30363d;
            border-radius: 8px;
            margin-bottom: 8px;
            background: rgba(13, 17, 23, 0.6);
            transition: border-color 0.2s ease;
        }

        .event-item:hover {
            border-color: #388bfd;
        }

        .event-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .event-info strong {
            color: #e6edf3;
            font-weight: 600;
        }

        .event-info .event-age {
            color: #7d8590;
            font-size: 0.9rem;
            background: rgba(22, 27, 34, 0.8);
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px solid #30363d;
        }

        .event-cost {
            color: #1f6feb;
            font-weight: 600;
            font-size: 0.95rem;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                border-right: none;
                border-bottom: 1px solid #30363d;
                max-height: none;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .result-cards {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .progress-details {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .event-info {
                flex-direction: column;
                align-items: flex-start;
                gap: 6px;
            }
        }

        .pulse {
            animation: pulse 1.5s ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.02); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .empty-state {
            color: #7d8590;
            font-style: italic;
            text-align: center;
            padding: 24px 16px;
            background: rgba(13, 17, 23, 0.3);
            border-radius: 8px;
            border: 1px dashed #30363d;
            font-size: 0.9rem;
        }

        .empty-state::before {
            content: "üìù";
            display: block;
            font-size: 1.5rem;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ Lifetime Spending Calculator</h1>
            <p>Calculate the lump sum needed to maintain your spending power for life</p>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="input-section">
                    <div class="section-title">Basic Information</div>
                    
                    <div class="input-group">
                        <label for="currentAge">Current Age</label>
                        <input type="number" id="currentAge" value="30" min="1" max="100">
                    </div>
                    
                    <div class="input-group">
                        <label for="currentSavings">Current Savings ($)</label>
                        <input type="number" id="currentSavings" value="100000" min="0" step="1000">
                    </div>
                    
                    <div class="input-group">
                        <label for="annualSpend">Current Annual Spending ($)</label>
                        <input type="number" id="annualSpend" value="50000" min="0" step="1000">
                    </div>
                    
                    <div class="input-group">
                        <label for="deathAge">Expected Death Age</label>
                        <input type="number" id="deathAge" value="85" min="1" max="120">
                    </div>
                    
                    <div class="input-group">
                        <label for="inflationRate">Inflation Rate (%)</label>
                        <input type="number" id="inflationRate" value="3" min="0" max="20" step="0.1">
                    </div>
                    
                    <div class="input-group">
                        <label for="investmentReturn">Investment Growth Rate (%)</label>
                        <input type="number" id="investmentReturn" value="7" min="0" max="30" step="0.1">
                    </div>

                    <div class="formula-info">
                        <strong>How it works:</strong>
                        This calculator finds the present value of your future spending needs, accounting for inflation while assuming your money grows through investments. It compares this to your current savings to show your funding status.
                    </div>
                </div>

                <div class="life-events-section">
                    <div class="section-title">Major Life Purchases</div>
                    
                    <div class="add-event-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Item</label>
                                <input type="text" id="newEventItem" placeholder="Wedding, House, Car...">
                            </div>
                            <div class="form-group">
                                <label>Age</label>
                                <input type="number" id="newEventAge" placeholder="35" min="1" max="120">
                            </div>
                            <div class="form-group">
                                <label>Cost ($)</label>
                                <input type="number" id="newEventCost" placeholder="50,000" min="0" step="1000">
                            </div>
                        </div>
                        <button class="btn-primary btn-add" onclick="addLifeEvent()">Add Life Event</button>
                    </div>
                    
                    <div id="lifeEventsList"></div>
                </div>
            </div>
            
            <div class="content-area">
                <div class="results-grid">
                    <div class="funding-status">
                        <div class="savings-progress">
                            <div class="progress-header">
                                <span class="progress-title">Funding Progress</span>
                                <span class="progress-percentage" id="fundingPercentage">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                        </div>
                        
                        <div class="progress-details">
                            <div class="detail-card">
                                <div class="detail-label">Savings Gap</div>
                                <div class="detail-value" id="savingsGap">$0</div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-label">Excess Funding</div>
                                <div class="detail-value" id="excessFunding">$0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="result-cards">
                        <div class="result-card">
                            <h3>Total Lump Sum Needed</h3>
                            <div class="value currency" id="lumpSum">$0</div>
                        </div>
                        
                        <div class="result-card">
                            <h3>Life Events Fund</h3>
                            <div class="value currency" id="lifeEventsSum">$0</div>
                        </div>
                        
                        <div class="result-card">
                            <h3>Remaining Years</h3>
                            <div class="value" id="remainingYears">0</div>
                        </div>
                        
                        <div class="result-card">
                            <h3>Final Year Spending</h3>
                            <div class="value currency" id="finalYearSpend">$0</div>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-title">Annual Spending Over Time</div>
                    <canvas id="spendingChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        let chart;
        let lifeEvents = [];
        
        function formatCurrency(value) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(Math.abs(value));
        }

        function addLifeEvent() {
            const item = document.getElementById('newEventItem').value.trim();
            const age = parseInt(document.getElementById('newEventAge').value);
            const cost = parseFloat(document.getElementById('newEventCost').value);
            
            if (!item || !age || !cost || cost <= 0) {
                alert('Please fill in all fields with valid values');
                return;
            }
            
            const currentAge = parseInt(document.getElementById('currentAge').value);
            const deathAge = parseInt(document.getElementById('deathAge').value);
            
            if (age <= currentAge || age >= deathAge) {
                alert('Age must be between your current age and death age');
                return;
            }
            
            lifeEvents.push({ item, age, cost, id: Date.now() });
            
            // Clear form
            document.getElementById('newEventItem').value = '';
            document.getElementById('newEventAge').value = '';
            document.getElementById('newEventCost').value = '';
            
            updateLifeEventsList();
            calculateLumpSum();
        }
        
        function removeLifeEvent(id) {
            lifeEvents = lifeEvents.filter(event => event.id !== id);
            updateLifeEventsList();
            calculateLumpSum();
        }
        
        function updateLifeEventsList() {
            const container = document.getElementById('lifeEventsList');
            
            if (lifeEvents.length === 0) {
                container.innerHTML = '<div class="empty-state">No major purchases added yet</div>';
                return;
            }
            
            const sortedEvents = [...lifeEvents].sort((a, b) => a.age - b.age);
            
            container.innerHTML = sortedEvents.map(event => `
                <div class="event-item">
                    <div class="event-info">
                        <strong>${event.item}</strong>
                        <span class="event-age">Age ${event.age}</span>
                        <span class="event-cost">${formatCurrency(event.cost)}</span>
                    </div>
                    <button class="btn-danger" onclick="removeLifeEvent(${event.id})">Remove</button>
                </div>
            `).join('');
        }

        function updateFundingStatus(currentSavings, totalNeeded) {
            const fundingRatio = totalNeeded > 0 ? currentSavings / totalNeeded : 1;
            const percentage = Math.min(fundingRatio * 100, 100);
            const gap = Math.max(totalNeeded - currentSavings, 0);
            const excess = Math.max(currentSavings - totalNeeded, 0);
            
            // Update progress bar
            const progressFill = document.getElementById('progressFill');
            const progressPercentage = document.getElementById('fundingPercentage');
            
            progressFill.style.width = percentage + '%';
            progressPercentage.textContent = percentage.toFixed(1) + '%';
            
            if (fundingRatio >= 1) {
                progressFill.classList.add('over-funded');
                progressPercentage.style.color = '#2ea043';
            } else {
                progressFill.classList.remove('over-funded');
                progressPercentage.style.color = '#1f6feb';
            }
            
            // Update gap/excess
            const gapElement = document.getElementById('savingsGap');
            const excessElement = document.getElementById('excessFunding');
            
            if (gap > 0) {
                gapElement.textContent = formatCurrency(gap);
                gapElement.className = 'detail-value negative';
                excessElement.textContent = '$0';
                excessElement.className = 'detail-value';
            } else {
                gapElement.textContent = '$0';
                gapElement.className = 'detail-value';
                excessElement.textContent = formatCurrency(excess);
                excessElement.className = 'detail-value positive';
            }
        }

        function calculateLumpSum() {
            const currentAge = parseInt(document.getElementById('currentAge').value);
            const currentSavings = parseFloat(document.getElementById('currentSavings').value) || 0;
            const annualSpend = parseFloat(document.getElementById('annualSpend').value);
            const deathAge = parseInt(document.getElementById('deathAge').value);
            const inflationRate = parseFloat(document.getElementById('inflationRate').value) / 100;
            const investmentReturn = parseFloat(document.getElementById('investmentReturn').value) / 100;
            
            const remainingYears = deathAge - currentAge;
            
            if (remainingYears <= 0) {
                alert('Death age must be greater than current age');
                return;
            }
            
            let lumpSumSpending = 0;
            let lumpSumLifeEvents = 0;
            const yearlyData = [];
            
            // Calculate present value of each year's regular spending
            for (let year = 1; year <= remainingYears; year++) {
                const inflatedSpending = annualSpend * Math.pow(1 + inflationRate, year);
                const presentValue = inflatedSpending / Math.pow(1 + investmentReturn, year);
                lumpSumSpending += presentValue;
                
                yearlyData.push({
                    year: currentAge + year,
                    age: currentAge + year,
                    nominalSpending: inflatedSpending,
                    realSpending: annualSpend,
                    lifeEvents: []
                });
            }
            
            // Calculate present value of life events
            lifeEvents.forEach(event => {
                const yearsFromNow = event.age - currentAge;
                if (yearsFromNow > 0 && yearsFromNow <= remainingYears) {
                    const inflatedCost = event.cost * Math.pow(1 + inflationRate, yearsFromNow);
                    const presentValue = inflatedCost / Math.pow(1 + investmentReturn, yearsFromNow);
                    lumpSumLifeEvents += presentValue;
                    
                    // Add to yearly data
                    const yearIndex = yearsFromNow - 1;
                    if (yearIndex >= 0 && yearIndex < yearlyData.length) {
                        yearlyData[yearIndex].lifeEvents.push({
                            ...event,
                            inflatedCost
                        });
                    }
                }
            });
            
            const totalLumpSum = lumpSumSpending + lumpSumLifeEvents;
            const finalYearSpending = annualSpend * Math.pow(1 + inflationRate, remainingYears);
            
            // Update display
            document.getElementById('lumpSum').textContent = formatCurrency(totalLumpSum);
            document.getElementById('lifeEventsSum').textContent = formatCurrency(lumpSumLifeEvents);
            document.getElementById('remainingYears').textContent = remainingYears;
            document.getElementById('finalYearSpend').textContent = formatCurrency(finalYearSpending);
            
            // Update funding status
            updateFundingStatus(currentSavings, totalLumpSum);
            
            // Add pulse animation to lump sum
            const lumpSumElement = document.getElementById('lumpSum');
            lumpSumElement.classList.add('pulse');
            setTimeout(() => lumpSumElement.classList.remove('pulse'), 1500);
            
            updateChart(yearlyData);
        }
        
        function updateChart(data) {
            const ctx = document.getElementById('spendingChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }
            
            Chart.defaults.color = '#e6edf3';
            Chart.defaults.borderColor = '#30363d';
            
            const years = data.map(d => d.age);
            const nominalSpending = data.map(d => d.nominalSpending);
            const realSpending = data.map(d => d.realSpending);
            
            // Prepare life events data for chart
            const lifeEventsData = data.map(yearData => {
                if (yearData.lifeEvents && yearData.lifeEvents.length > 0) {
                    return yearData.lifeEvents.reduce((sum, event) => sum + event.inflatedCost, 0);
                }
                return 0;
            });
            
            const datasets = [{
                label: 'Annual Spending (Inflation Adjusted)',
                data: nominalSpending,
                type: 'line',
                borderColor: '#1f6feb',
                backgroundColor: 'rgba(31, 111, 235, 0.1)',
                borderWidth: 3,
                fill: true,
                tension: 0.4,
                yAxisID: 'y'
            }, {
                label: 'Real Spending Power (Today\'s Dollars)',
                data: realSpending,
                type: 'line',
                borderColor: '#58a6ff',
                backgroundColor: 'rgba(88, 166, 255, 0.1)',
                borderWidth: 2,
                fill: false,
                tension: 0.4,
                borderDash: [5, 5],
                yAxisID: 'y'
            }];
            
            // Add life events as bars if there are any
            if (lifeEventsData.some(d => d > 0)) {
                datasets.push({
                    label: 'Major Life Purchases',
                    data: lifeEventsData,
                    type: 'bar',
                    backgroundColor: 'rgba(248, 81, 73, 0.7)',
                    borderColor: '#f85149',
                    borderWidth: 2,
                    yAxisID: 'y1'
                });
            }
            
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                color: '#e6edf3'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(22, 27, 34, 0.95)',
                            titleColor: '#e6edf3',
                            bodyColor: '#e6edf3',
                            borderColor: '#30363d',
                            borderWidth: 1,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label + ': ' + formatCurrency(context.parsed.y);
                                    
                                    // Add life event details if this is a life event bar
                                    if (context.dataset.label === 'Major Life Purchases' && context.parsed.y > 0) {
                                        const yearData = data[context.dataIndex];
                                        if (yearData.lifeEvents && yearData.lifeEvents.length > 0) {
                                            label += '\n' + yearData.lifeEvents.map(e => `‚Ä¢ ${e.item}: ${formatCurrency(e.inflatedCost)}`).join('\n');
                                        }
                                    }
                                    
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Age',
                                font: {
                                    weight: 'bold'
                                },
                                color: '#e6edf3'
                            },
                            grid: {
                                color: '#30363d'
                            },
                            ticks: {
                                color: '#e6edf3'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Annual Spending ($)',
                                font: {
                                    weight: 'bold'
                                },
                                color: '#e6edf3'
                            },
                            grid: {
                                color: '#30363d'
                            },
                            ticks: {
                                color: '#e6edf3',
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Life Event Cost ($)',
                                font: {
                                    weight: 'bold'
                                },
                                color: '#e6edf3'
                            },
                            grid: {
                                drawOnChartArea: false,
                                color: '#30363d'
                            },
                            ticks: {
                                color: '#e6edf3',
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Add event listeners
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', calculateLumpSum);
        });
        
        // Add Enter key support for life events form
        ['newEventItem', 'newEventAge', 'newEventCost'].forEach(id => {
            document.getElementById(id).addEventListener('keypress', function(e) {
                if (e.key === 'Enter') addLifeEvent();
            });
        });
        
        // Initial setup
        updateLifeEventsList();
        calculateLumpSum();
    </script>
</body>
</html>